(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var a={},s=[],o=0;o<e.length;o++){var c=e[o],l=r.base?c[0]+r.base:c[0],d=a[l]||0,h="".concat(l," ").concat(d);a[l]=d+1;var p=n(h),u={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(u);else{var f=i(u,r);r.byIndex=o,t.splice(o,0,{identifier:h,updater:f,references:1})}s.push(h)}return s}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var a=r(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var o=n(a[s]);t[o].references--}for(var c=r(e,i),l=0;l<a.length;l++){var d=n(a[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}a=c}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(s[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);r&&s[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),i&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=i):d[4]="".concat(i)),t.push(d))}},t}},365:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(601),i=n.n(r),a=n(314),s=n.n(a)()(i());s.push([e.id,'/*\n  Josh\'s Custom CSS Reset\n  https://www.joshwcomeau.com/css/custom-css-reset/\n*/\n\n*,\n*::before,\n*::after {\n  box-sizing: border-box;\n}\n\n* {\n  margin: 0;\n}\n\n@media (prefers-reduced-motion: no-preference) {\n  html {\n    interpolate-size: allow-keywords;\n  }\n}\n\nbody {\n  line-height: 1.5;\n  -webkit-font-smoothing: antialiased;\n}\n\nimg,\npicture,\nvideo,\ncanvas,\nsvg {\n  display: block;\n  max-width: 100%;\n}\n\ninput,\nbutton,\ntextarea,\nselect {\n  font: inherit;\n}\n\np,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  overflow-wrap: break-word;\n}\n\np {\n  text-wrap: pretty;\n}\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  text-wrap: balance;\n}\n\nbody {\n  padding: 0 clamp(10%, 20%, 30%) 0 clamp(10%, 20%, 30%);\n}\n.messages {\n  height: 4vh;\n  width: 60%;\n  background: #f8f8f8;\n  text-align: center;\n  font-size: 14px;\n  padding: 0.5rem;\n}\n.pass-device {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  background: lightblue;\n  font-size: 96px;\n  color: white;\n  padding: 20%;\n}\n.hidden {\n  display: none;\n}\n#root,\n#__next {\n  isolation: isolate;\n}\n\n.game {\n  display: flex;\n  gap: 40px;\n  justify-content: center;\n  align-items: center;\n  width: fit-content;\n}\n\n.header {\n  display: flex;\n  align-items: center;\n  justify-content: start;\n  margin-bottom: 5vh;\n  gap: 10%;\n}\n\n.battlefield_container {\n  flex-shrink: 0;\n  display: grid;\n  grid-template-columns: repeat(11, 1fr);\n  grid-auto-rows: repeat(11, 1fr);\n}\n.battlefield {\n  grid-row: 2 / 11;\n  grid-column: 2 / 11;\n  display: flex;\n  flex-direction: column;\n  width: fit-content;\n  border: 0.00125rem solid rgb(160, 160, 255);\n  background: white;\n}\n\n.row {\n  display: flex;\n  border-bottom: 0.00125rem solid rgb(160, 160, 255);\n}\n.row:last-child {\n  border-bottom: none;\n}\n.cell {\n  width: 3vh;\n  height: 3vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-right: 0.0625rem solid rgb(160, 160, 255);\n}\n.cell:last-child {\n  border-right: none !important;\n}\n\n.hit::after {\n  content: "❌";\n  font-size: clamp(4px, 100%, 12px);\n}\n.missed-hit::after {\n  color: gray;\n  font-size: 0.625rem;\n  content: "●";\n}\n.battlefield_opponent .cell:hover {\n  cursor: pointer;\n  border: none;\n  background: #d0f0c0;\n  opacity: 0.4;\n  border: 2px solid lightgreen;\n}\n.cell.hit {\n  border: 2px solid #00f;\n  background: rgba(0, 0, 255, 0.05);\n}\n\n.header-item {\n  width: 3vh;\n  height: 3vh;\n  text-align: center;\n  font-size: 12px;\n}\n.col-header {\n  display: flex;\n  grid-column: 2 / 11;\n  grid-row: 1;\n}\n.row-header {\n  display: flex;\n  flex-direction: column;\n  grid-column: 1;\n  grid-row: 3 / 11;\n}\n\n.desp {\n  grid-column: 5 / 11;\n  grid-row: 12;\n  padding: 4px;\n}\n.static {\n  border: 2px solid #00f;\n}\n.cell.horizontal-head {\n  border-left: 2px solid #00f;\n}\n\n.cell.horizontal-tail {\n  border-right: 2px solid #00f !important;\n}\n.cell.horizontal-body {\n  border-top: 2px solid #00f;\n  border-bottom: 2px solid #00f;\n}\n\n.cell.vertical-head {\n  border-top: 2px solid #00f;\n}\n.cell.vertical-tail {\n  border-bottom: 2px solid #00f;\n}\n.cell.vertical-body {\n  border-left: 2px solid #00f;\n  border-right: 2px solid #00f;\n}\n\n.start-game,\n.ready-game {\n  grid-column: 2 / 11;\n  grid-row: 2 / 11;\n  position: relative;\n  background: rgba(255, 255, 255, 0.8);\n  position: relative;\n}\n\n#startGame,\n#ready {\n  position: relative;\n  top: 20px;\n  background: lightgreen;\n  width: 60px;\n  padding: 5px;\n  font-size: 18px;\n  border: none;\n}\n#ready {\n  width: fit-content;\n}\ninput[type="radio"] {\n  opacity: 0;\n  position: fixed;\n  width: 0;\n}\n\ninput[type="radio"]:checked + label {\n  background: #f8f8f8;\n  padding: 4px;\n  text-decoration: underline;\n}\n\nlabel,\nbutton {\n  cursor: pointer;\n  position: relative;\n}\n\nlegend {\n  font-size: 18px;\n  font-weight: semi-bold;\n}\nfieldset {\n  border: none;\n  font-size: 16px;\n}\ndiv[drag="true"] {\n  cursor: move; /* fallback if grab cursor is unsupported */\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n\n#randomise,\n#reset {\n  background: none;\n  border: none;\n  color: blue;\n}\n\n#randomise:hover,\n#reset:hover {\n  color: lightgreen;\n}\n\n.b-wrapper {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n\n.rules > p {\n  margin-top: 2%;\n  padding: 5px;\n  background: lightgreen;\n  border-radius: 5px;\n  color: green;\n}\n.container {\n  background: white;\n  padding: 5% 5%;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n}\n.description {\n  flex-grow: 1;\n}\n.footer {\n  margin-top: 2%;\n  border-top: 1px solid gray;\n}\n@media screen and (max-width: 768px) {\n  body {\n    padding: 2% 10% 0 10%;\n  }\n  .game {\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n  }\n}\n',""]);const o=s},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.nc=void 0;var r=n(72),i=n.n(r),a=n(825),s=n.n(a),o=n(659),c=n.n(o),l=n(56),d=n.n(l),h=n(540),p=n.n(h),u=n(113),f=n.n(u),m=n(365),b={};b.styleTagTransform=f(),b.setAttributes=d(),b.insert=c().bind(null,"head"),b.domAPI=s(),b.insertStyleElement=p(),i()(m.A,b),m.A&&m.A.locals&&m.A.locals;const g=n.p+"c37b2dfc511d1a03ea65.png",y=n.p+"a3447119809d97968feb.png",v=class{constructor(e){this.name=e}get ships(){return this._ships}set ships(e){return this._ships=e,this}get opponent(){return this._opponent}get board(){return this._gameboard.board}set opponent(e){return this._opponent=e,this}set gameboard(e){return this._gameboard=e,this}get gameboard(){return this._gameboard}};Array.prototype.sample=function(){return this[~~(Math.random()*this.length)]};const x=(()=>{function e(e,t){return[[e-1,t-1],[e-1,t],[e-1,t+1],[e,t-1],[e,t+1],[e+1,t-1],[e+1,t],[e+1,t+1]].filter(([e,t])=>n(e,t))}function t(){return Math.floor(9*Math.random())}function n(e,t){return e<10&&e>=0&&t<10&&t>=0}return{randomPoint:function(){let[e,n]=[t(),t()];return[e,n]},validCoordinates:n,adjacent:e,adjacentEmpty:function(t,n,r=[]){let i=e(t,n);for(let[e,t]of i)if(null!==r[e][t])return!1;return!0},randomDirX:function(){return[-1,0,1].sample()},randomDirY:function(){return[1,-1].sample()},validEndPoint:function(e,t,r,i,a){return a-=1,n(0===r?e:e+r*a,0===i?t:t+i*a)},sleep:function(e){return new Promise(t=>setTimeout(t,e))},getShip:function(e,t){let[n,r]=e,i=t.board[n][r];return t.ships[i]},getShipById:function(e,t){return t.ships[e]}}})();let w={};w.Computer=class extends v{constructor(e){super(e),this.missedHits={},this.hits={},this.hotPoints=[]}makeMove(){let e,t=!1;for(;!t;)e=this.hotPoints.length>0?this.hotPoints.shift():x.randomPoint(),this.freePoint(e)&&(t=!0);let n=this._opponent.gameboard.receiveAttack(...e);return"hit"===n?(this.hits[e]=!0,x.adjacent(...e).forEach(e=>this.hotPoints.push(e))):this.missedHits[e]=!0,n}freePoint(e){return!this.missedHits[e]&&!this.hits[e]}},w.Gameboard=class{constructor(){this.board=[],this.ships={},this.occupiedCells={};for(let e=0;e<10;e++)this.board[e]=new Array(10).fill(null)}receiveAttack(e,t){if(!x.validCoordinates(e,t))return;let n=this.board[e][t],r=this.ships[n];return"hit"===n||"missed-hit"===n?"target-twice":r?(r.hit(),this.board[e][t]="hit","hit"):(this.board[e][t]="missed-hit","missed-hit")}rotateShip(e,t){let n=this.ships[e],r=n.direction,i=n.location.toSorted();if(i.length<=1)return;let a={up:[],down:[],left:[],right:[]};this.clear(n.location);let[s,o]=t>i[0]?i[i.length-1]:i[0];for(let e=0;e<i.length;e++)"horizontal"===r?(a.down.push([s-e,o]),a.up.push([s+e,o])):"vertical"===r&&(a.right.push([s,o+e]),a.left.push([s,o-e]));for(let e of Object.values(a))if(Array.isArray(e)&&e.length&&this.validPlace(e))return n.direction="horizontal"===r?"vertical":"horizontal",this.clear(n.location),this.place(e,n),!0;return this.place(i,n),!1}allSunk(){return Object.values(this.ships).every(e=>!0===e.isSunk())}place(e,t){if(!this.validPlace(e))return!1;let n;n=this.ships[t.id]?t.id:crypto.randomUUID(),this.ships[n]=t,t.id=n,t.location=e;for(let[t,r]of e)this.board[t][r]=n;return!0}validPlace(e){for(let[t,n]of e)if(!x.validCoordinates(t,n)||!x.adjacentEmpty(t,n,this.board)||null!==this.board[t][n])return!1;return!0}clear(e){for(let[t,n]of e)this.board[t][n]=null}placeRandom(e){let t=e.length,n=[],r="",i={};for(;n.length<t;){let e=x.randomPoint(),[a,s]=e,o=x.randomDirX(),c=0===o?x.randomDirY():0,l=`${e}-${o}-${c}`;if(x.validEndPoint(a,s,o,c,t)&&!i[l]&&!this.occupiedCells[e]){i[l]=!0,n.push([a,s]);for(let e=1;e<t;e++){let t=0===c?s:s+e*c,i=0===o?a:a+e*o;if(this.occupiedCells[[i,t]]){r="",n=[];break}if(!x.validCoordinates(i,t)||null!==this.board[i][t]){r="",n=[];break}r=0===o?"horizontal":"vertical",n.push([i,t])}}}n.forEach(e=>{this.occupiedCells[e]=!0,x.adjacent(e[0],e[1]).forEach(e=>this.occupiedCells[e]?"":this.occupiedCells[e]=!0)}),e.direction=r,this.place(n,e)}},w.Player=v,w.Ship=class{constructor(e){this.length=e,this.hits=0}hit(){this.hits++}isSunk(){return this.hits===this.length}get location(){return this._location}set location(e){this._location=e}get direction(){return this._direction}set direction(e){this._direction=e}set id(e){this._id=e}get id(){return this._id}};class k{static events={};static emit(e,t){this.events[e]&&this.events[e].forEach(function(e){e(t)})}static subscribe(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)}static unsubscribe(e,t){if(this.events[e])for(var n=0;n<this.events[e].length;n++)if(this.events[e][n]===t){this.events[e].splice(n,1);break}}static purge(){k.events={}}static show(){console.log(this.events)}static bulk(e,...t){let n=Object.assign({},...t);for(let[t,r]of Object.entries(n))switch(e){case"subscribe":k.emit(t+"-on"),k.subscribe(t,r);break;case"unsubscribe":k.emit(t+"-off"),k.unsubscribe(t,r);break;case"restart":k.emit(t+"-off"),k.unsubscribe(t,r),k.emit(t+"-on"),k.subscribe(t,r)}}}const _=(()=>{k.subscribe("randomise-on",()=>n()),k.subscribe("randomise-off",()=>r());let e=document.querySelector("#randomise");const t=()=>{k.emit("randomise")},n=()=>{e.classList.remove("hidden"),e.addEventListener("click",t)},r=()=>{e.removeEventListener("click",t),e.classList.add("hidden")}})(),S=(()=>{let e,t,n;k.subscribe("start-on",()=>i()),k.subscribe("start-off",()=>a());const r=t=>{let n;t.preventDefault();for(const t of e)if(t.checked){n=t.value;break}k.emit("start",n),a()},i=()=>{n=document.querySelector("#startGame"),t=document.querySelector(".start-game"),e=document.querySelectorAll('input[name="player"]'),t.classList.remove("hidden"),n.addEventListener("click",r)},a=()=>{t.classList.add("hidden"),n.removeEventListener("click",r)}})(),E=e=>{try{return e.parentElement.parentElement.classList.contains("battlefield_opponent")}catch(e){console.log(e)}},P=e=>{let t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return[Number(t),Number(n)]},A=(()=>{k.subscribe("attack-on",()=>n()),k.subscribe("attack-off",()=>{r()});let e=document.querySelector(".battlefield_container.opponent");const t=e=>{let t=e.target;if(E(t)){e.preventDefault(),e.stopPropagation();let n=P(t);return void k.emit("attack",n)}},n=()=>{e.addEventListener("click",t)},r=()=>{e.removeEventListener("click",t)}})(),L=(()=>{k.subscribe("reset-on",()=>n()),k.subscribe("reset-off",()=>r());let e=document.querySelector("#reset");const t=()=>{k.emit("reset")},n=()=>{e.classList.remove("hidden"),e.addEventListener("click",t)},r=()=>{e.removeEventListener("click",t),e.classList.add("hidden")}})();class C{static params={};static getParam(e){return this.params[e]}static setParam(e,t){this.params[e]=t}static bulkSet(e={}){Object.keys(e).forEach(t=>this.params[t]=e[t])}static bulkGet(...e){let t=[];return e.forEach(e=>t.push(this.params[e])),t}static purge(){this.params={}}static show(){console.log(this.params)}}const j=(()=>{let e=[];k.subscribe("dragstart-on",()=>r()),k.subscribe("color",e=>color=e),k.subscribe("dragstart-off",()=>i());let t=document.querySelector(".battlefield_container.self");const n={dragstart:e=>{if(e.target.hasAttribute("drag")){let t=P(e.target);k.emit("dragstart",t)}},dragover:t=>{let n=t.target;if(t.preventDefault(),n.hasAttribute("drag")||!n.classList.contains("cell"))return;let[r,i,a]=C.bulkGet("shipLength","shipDirection","dragOverColor"),l=n.parentElement.parentElement;s();let[d,h]=P(n);switch(i){case"vertical":c(l,r,d,h);break;case"horizontal":o(l,r,d,h);break;default:e.push(n)}let p=e.map(e=>P(e));k.emit("dragover",p),e.forEach(e=>e.style.cssText=`border: 2px solid ${a}`)},drop:t=>{t.preventDefault();let n=C.getParam("shipLength");if(e.length!==n)return;let r=C.getParam("shipId"),i=[];e.forEach(e=>{i.push(P(e))}),k.emit("drop",{id:r,newLocation:i})}},r=()=>{Object.keys(n).forEach(e=>t.addEventListener(e,n[e]))},i=()=>{e=[],Object.keys(n).forEach(e=>t.removeEventListener(e,n[e]))},a=(e,t)=>e<10&&e>=0&&t<10&&t>=0,s=()=>{for(;e.length>0;)e.shift().style.cssText=""},o=(t,n,r,i)=>{let o=Array.from(t.children),c=Array.from(o[r].children);for(let t=0;t<n;t++){if(!a(r,i+t)){s();break}let n=c[i+t];if(n.hasAttribute("drag")){s();break}e.push(n)}},c=(t,n,r,i)=>{let o=Array.from(t.children);for(let t=0;t<n;t++){if(!a(r+t,i)){s();break}let n=Array.from(o[r+t].children)[i];if(n.hasAttribute("drag")){s();break}e.push(n)}}})(),q=(()=>{k.subscribe("rotate-on",()=>n()),k.subscribe("rotate-off",()=>{r()});let e=document.querySelector(".battlefield_container.self");const t=e=>{e.preventDefault();let t=e.target;if(t.classList.contains("rotatable")){let e=P(t);k.emit("rotate",e)}},n=()=>{e.addEventListener("click",t)},r=()=>{e.removeEventListener("click",t)}})(),R=(()=>{let e,t;k.subscribe("ready-on",()=>r()),k.subscribe("ready-off",()=>i());const n=()=>{k.emit("ready"),i()},r=()=>{t=document.querySelector(".ready-game"),e=document.querySelector("#ready"),e.addEventListener("click",n)},i=()=>{e.removeEventListener("click",n),t.remove()}})();let z={};z.Randomise=_,z.Start=S,z.Attack=A,z.Reset=L,z.DragNdrop=j,z.Rotate=q,z.Ready=R;const D=(e=>{const t=e.querySelector(".game"),n=e.querySelector(".pass-device"),r=n.querySelector(".time");return{clear:t=>{e.querySelector(t).textContent=""},showCourtain:()=>{n.classList.toggle("hidden"),r.textContent=".";for(let e=1;e<10;e++)setTimeout(()=>r.textContent=r.textContent+".",1e3*e)},hideCourtain:()=>{n.classList.toggle("hidden")},addPanel:()=>{let n=e.createElement("div");n.innerHTML='\n            <form style="pointer-events: auto;">\n                <fieldset>\n                    <legend>Opponent</legend>\n                    <div>\n                        <input type="radio" id="computer" name="player" value="computer" checked/>\n                        <label for="computer">Computer</label>\n\n                        <input type="radio" id="friend" name="player" value="friend" />\n                        <label for="friend">Friend</label>\n\n                    </div>\n\n                    <div>\n                        <button type="button" id="startGame">Play</button>\n                    </div>\n                </fieldset>\n            </form>',n.classList.add("start-game","hidden"),e.querySelector(".start-game")||t.querySelector(".battlefield_container.opponent").append(n)},message:t=>{e.querySelector(".messages").textContent=t},addFightPanel:()=>{let n=e.createElement("div");n.innerHTML='\n            <form>\n                <fieldset>\n                    <div>\n                        <button type="button" id="ready">I am ready!</button>\n                    </div>\n                </fieldset>\n            </form>',n.classList.add("ready-game"),e.querySelector(".ready-game")||t.querySelector(".battlefield_container.opponent").append(n)}}})(document),T=(e=>{const t=(e,t)=>{switch(e.classList.add("col","cell"),t){case"hit":e.classList.add("hit");break;case"missed-hit":e.classList.add("missed-hit");break;default:e.classList.add("empty")}};return{build:(n,r,i)=>{for(let i=0;i<r.length;i++){let a=e.createElement("div");a.setAttribute("class","row");for(let n=0;n<r[i].length;n++){let s=r[i][n],o=e.createElement("div");o.setAttribute("data-x",i),o.setAttribute("data-y",n),t(o,s),a.append(o)}n.append(a)}}}})(document),O=(()=>{const e=(e,t,n,r="body")=>{let[i,a]=t,s=Array.from(e.children),o=Array.from(s[i].children);switch(o[a].setAttribute("drag","true"),o[a].classList.add("rotatable"),n){case"horizontal":o[a].classList.add(`horizontal-${r}`);break;case"vertical":o[a].classList.add(`vertical-${r}`);break;case"":o[a].classList.add("static")}};return{place:(t,n,r)=>{if("self"===r)for(let r of t){let t=r.location.sort();for(let i=0;i<t.length;i++){let a=t[i],s=r.direction;0===i?e(n,a,s,"head"):i===t.length-1&&e(n,a,s,"tail"),e(n,a,s)}}}}})(),I=(e=>{const t=(t,n,r)=>{let i=e.createElement("div");i.setAttribute("class",r);for(let t of n){let n=e.createElement("p");n.textContent=t,n.setAttribute("class","header-item"),i.append(n)}t.append(i)};return{col:e=>{let n=[...Array(10).keys()];t(e,n,"row-header")},row:e=>{t(e,["A","B","C","D","E","F","G","H","I","J"],"col-header")}}})(document),M=(e=>{e.querySelector(".game");const t=e.querySelector(".battlefield_container.self"),n=e.querySelector(".battlefield_container.opponent"),r=e.querySelector(".battlefield.battlefield_self"),i=e.querySelector(".battlefield.battlefield_opponent");[t,n].forEach(e=>{I.col(e),I.row(e)});const a=(e,t,n)=>{e.textContent="",T.build(e,t.board,n),O.place(Object.values(t.ships),e,n)};return{render:(...e)=>{let t="self-opponent".split("-"),n=0;[r,i].forEach(r=>{a(r,e[n],t[n]),n++})},clearAndPrepend:e=>{a(r,e,"self")}}})(document),N=(e,t={})=>{switch(e){case"game":M.render(t.current_player.gameboard,t.current_player.opponent.gameboard);break;case"panel":D.addPanel();break;case"fight":D.addFightPanel()}},G=e=>{e.includes("-")&&(e=e.split("-").join(" ")),e=e[0].toUpperCase()+e.slice(1)+".",D.message(e)},$=(e,t)=>{"board"===e&&M.clearAndPrepend(t.gameboard)},F=e=>{"courtain"===e&&(D.showCourtain(),setTimeout(()=>{D.hideCourtain()},3e3))},H=class{static c;static on(e){this.c=e,k.bulk("subscribe",this.fns)}static off(){k.bulk("unsubscribe",this.fns)}static restart(){k.bulk("restart",this.fns)}},B=class extends H{static ready(){N("game",{current_player:this.c.current_player}),this.c.start(),this.off()}static fns={ready:()=>this.ready()}};let U={};U.Attack=class extends H{static async attack(e){let t=this.c.current_player.opponent.gameboard.receiveAttack(...e);await this.attackResponse(t),G(t),N("game",{current_player:this.c.current_player})}static async attackResponse(e){if("target-twice"!==e){if("hit"===e&&this.c.current_player.opponent.gameboard.allSunk())G("Game over "+this.c.current_player.name+" won."),this.c.end();else if("missed-hit"===e){let e;if("computer"===this.c.current_player.opponent.name){for(e=this.c.player2.makeMove(),G(e),N("game",{current_player:this.c.current_player});"hit"===e;)if(await x.sleep(1e3),e=this.c.player2.makeMove(),G(e),N("game",{current_player:this.c.current_player}),this.c.player1.gameboard.allSunk())return G("Game over c0mput3r won."),void this.c.end()}else F("courtain"),this.c.switchPlayer()}}else G("Cannot target the same point twice")}static fns={attack:e=>this.attack(e)}},U.DragNDrop=class extends H{static dragstart(e){let t=x.getShip(e,this.c.current_player.gameboard);if(t){let e=Number(t.length),n=t.direction,r=t.id;this.c.current_player.gameboard.clear(t.location),C.bulkSet({shipLength:e,shipId:r,shipDirection:n})}}static dragover(e){let t=this.c.current_player.gameboard.validPlace(e)?"lightgreen":"red";C.setParam("dragOverColor",t)}static async drop(e,t){let n=x.getShipById(e,this.c.current_player.gameboard),r=n.location;this.c.current_player.gameboard.place(t,n)?(n.location=t,$("board",{gameboard:this.c.current_player.gameboard}),G("Position updated!")):this.c.current_player.gameboard.place(r,n)}static fns={dragstart:e=>this.dragstart(e),dragover:e=>this.dragover(e),drop:({id:e,newLocation:t})=>this.drop(e,t)}},U.Randomise=class extends H{static randomise(){this.c.newBoard(),this.c.update()}static fns={randomise:()=>this.randomise()}},U.Rotate=class extends H{static rotate(e){let t=x.getShip(e,this.c.current_player.gameboard);t&&this.c.current_player.gameboard.rotateShip(t.id,e)?($("board",{gameboard:this.c.current_player.gameboard}),G("Rotated!")):G("Cannot rotate!")}static fns={rotate:e=>this.rotate(e)}},U.Reset=class extends H{static reset(){this.c.reset()}static fns={reset:()=>this.reset()}},U.Start=class extends H{static start(e){"friend"==e?(this.c.setPlayer("friend"),this.c.switchPlayer(),F("courtain"),N("game",{current_player:this.c.current_player}),N("fight"),B.on(this.c)):this.c.start()}static fns={start:e=>this.start(e)}};const J=class{static c;static on(e){this.c=e,U.Start.on(this.c),U.DragNDrop.on(this.c),U.Rotate.on(this.c),U.Randomise.on(this.c)}static off(){U.Start.off(),U.DragNDrop.off(),U.Rotate.off(),U.Randomise.off()}};let X={};X.Init=J,X.Run=class{static c;static on(e){this.c=e,J.off(),U.Attack.on(this.c),U.Reset.on(this.c)}static off(){U.Attack.off(),U.Reset.off()}},document.querySelector("#favicon").href=y,document.body.style.cssText=`background: url(${g});`;let Y=new class{constructor(e,t){this.setPlayers(e,t)}init(){G("Place you ships and then start the game"),this.placeShips(this.player1,this.player2),N("game",{current_player:this.current_player}),N("panel"),X.Init.on(this)}update(){this.placeShips(this.current_player),$("board",{gameboard:this.current_player.gameboard})}reset(){X.Run.off(),this.setPlayers("axis","computer"),this.init()}start(){G("Fire a missile"),X.Run.on(this)}switchPlayer(){this.current_player=this.current_player===this.player1?this.player2:this.player1}placeShips(...e){let t=[4,3,3,2,2,2,1,1,1,1];for(let n of e)n.ships=t.map(e=>new w.Ship(e)),n.ships.forEach(e=>n.gameboard.placeRandom(e))}setPlayers(e,t){this.player1=new w.Player(e),this.player1.gameboard=new w.Gameboard,this.player2=new w.Computer(t),this.player2.gameboard=new w.Gameboard,this.current_player=this.player1,this.setOpponents(this.player1,this.player2)}setPlayer(e){let t=this.player2.gameboard;this.player2=new w.Player(e),this.player2.gameboard=t,this.current_player=this.player1,this.setOpponents(this.player1,this.player2)}setOpponents(e,t){e.opponent=t,t.opponent=e}newBoard(){this.current_player.gameboard=new w.Gameboard}}("axis","computer");Y.init()})();